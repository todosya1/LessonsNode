/*
Чтение данных из файлов:
Сначала из файла first.txt, затем из файла second.txt.
Файлы читаются асинхронно, чтобы не блокировать выполнение программы.
Запись нового файла:

После чтения обоих файлов их содержимое объединяется в строку и записывается в файл result-async.txt.
Логи для отслеживания прогресса:
Логи выводятся на каждом этапе: начало задачи, успешное выполнение или ошибка.
*/
// Импорт необходимых модулей
const { readFile, writeFile } = require('fs'); // Для работы с файлами
const path = require('path'); // Для построения путей

// Создаем путь к директории text
const dirPath = path.join(__dirname, '/text');

console.log('start'); // Лог для обозначения начала процесса

// Чтение первого файла
readFile(`${dirPath}/first.txt`, 'utf8', (err, result) => {
    if (err) {
        console.log(err); // Лог ошибки, если чтение не удалось
        return; // Завершаем выполнение в случае ошибки
    }
    const first = result; // Сохраняем содержимое первого файла

    // Чтение второго файла
    readFile(`${dirPath}/second.txt`, 'utf8', (err, result) => {
        if (err) {
            console.log(err); // Лог ошибки, если чтение не удалось
            return; // Завершаем выполнение в случае ошибки
        }
        const second = result; // Сохраняем содержимое второго файла

        // Запись результата в новый файл
        writeFile(
            `${dirPath}/result-async.txt`, // Путь к новому файлу
            `Here is the result: ${first}, ${second}`, // Содержимое нового файла
            (err, result) => {
                if (err) {
                    console.log(err); // Лог ошибки, если запись не удалась
                    return; // Завершаем выполнение в случае ошибки
                }
                console.log('done with this task'); // Лог успешного завершения записи
            }
        );
    });
});

console.log('starting next task'); // Лог выполнения следующей задачи
