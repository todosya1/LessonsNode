const express = require('express');
const app = express();
const port = process.env.PORT || 3011;

// –ü–µ—Ä–≤—ã–π middleware
// –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
app.use((req, res, next) => {
    console.log('üîç –ü–µ—Ä–≤—ã–π middleware:');
    console.log(`   –í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞: ${new Date().toLocaleString()}`);
    console.log(`   URL –∑–∞–ø—Ä–æ—Å–∞: ${req.url}`);
    console.log(`   –ú–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞: ${req.method}`);
    // next() –ø–µ—Ä–µ–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–º—É middleware
    next();
});

// –í—Ç–æ—Ä–æ–π middleware
// –¢–∞–∫–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
app.use((req, res, next) => {
    console.log('üéØ –í—Ç–æ—Ä–æ–π middleware:');
    console.log('   –ì–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç!');
    // res.send() –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
    // –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç res.write(), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤
    res.send('<h1>–ü—Ä–∏–≤–µ—Ç –æ—Ç Express!</h1>');
});

// –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
app.listen(port, () => {
    console.log(`
    üöÄ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:${port}
    
    üìù –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ:
    1. –ü–µ—Ä–≤—ã–π middleware –ª–æ–≥–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–ø—Ä–æ—Å–µ
    2. –§—É–Ω–∫—Ü–∏—è next() –ø–µ—Ä–µ–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–º—É middleware
    3. –í—Ç–æ—Ä–æ–π middleware –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É
    
    üí° –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É,
       —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –æ–±–æ–∏—Ö middleware
    `);
});

/*
–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞:
1. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
   - –ö–ª–∏–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
   - –ü–µ—Ä–≤—ã–π middleware –ª–æ–≥–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
   - next() –ø–µ—Ä–µ–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–ª—å—à–µ
   - –í—Ç–æ—Ä–æ–π middleware –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç
   - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

2. –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:
   - next() –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - res.send() –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
   - –ë–µ–∑ next() –≤—Ç–æ—Ä–æ–π middleware –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è
   - –ü–æ—Ä—è–¥–æ–∫ middleware –≤–∞–∂–µ–Ω

3. –ß—Ç–æ —É–≤–∏–¥–∏—Ç –∫–ª–∏–µ–Ω—Ç:
   - –í –±—Ä–∞—É–∑–µ—Ä–µ: "–ü—Ä–∏–≤–µ—Ç –æ—Ç Express!"
   - –í –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–ø—Ä–æ—Å–µ
*/